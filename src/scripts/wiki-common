#!/bin/bash

find_src_files ()
{
    find "$1" \
    ! -wholename '*include*' \
    ! -wholename '*xcode*' \
    ! -wholename '*enet*' \
    \( \
        -name '*.c' \
        -or -name '*.h' \
        -or -name '*.cpp' \
        -or -name '*.hpp' \
    \)
}

extract_src_def ()
{
	echo "$1" | grep '^[^A-Z]*[A-Z]*([^,]*, '"$2"', '
}

format_name ()
{
    echo "$1" | sed 's%^setdesc "\([^"]*\)".*%\1%'
}

format_name_weap ()
{
    echo "$1" | sed 's%^setdesc (concatword \$w \([^ ^)]*\).*%\1%'
}

format_desc ()
{
    echo "$1" | sed -e 's%\^n% %g' -e 's%\^"%ESC_QUOT%g' -e 's%^setdesc "[^"]*" "\([^"]*\)".*%\1%' -e 's%ESC_QUOT%"%g'
}

format_desc_weap ()
{
    echo "$1" | sed -e 's%\^n% %g' -e 's%\^"%ESC_QUOT%g' -e 's%^setdesc ([^)]*) "\([^"]*\)".*%\1%' -e 's%ESC_QUOT%"%g'
}

format_param ()
{
    echo "$1" | sed -n '/^setdesc "[^"]*" ".*" "\([^"]*\)"/{s%%\1%; s% %\&nbsp;%g; p;}'
}

format_param_weap ()
{
    echo "$1" | sed -n '/^setdesc ([^)]*) ".*" "\([^"]*\)"/{s%%\1%; s% %\&nbsp;%g; p;}'
}

noedit_header ()
{
    echo -e "This page was automatically generated from the source of Red Eclipse, please do not edit it manually.\n"
}

table_header ()
{
    cat <<EOF
{| border="1" class="wikitable sortable"
! Name&nbsp;&&nbsp;Parameters
! class="unsortable"|Description
! Type
! class="unsortable"|Range
! class="unsortable"|Default&nbsp;Value
EOF
}

table_entry ()
{
    if [ -n "$2" ]
    then
        cat <<EOF
|-
| '''$1'''&nbsp;''$2''
| $3
| $4
| $5
| $6
EOF
    else
        cat <<EOF
|-
| '''$1'''
| $3
| $4
| $5
| $6
EOF
    fi
}

table_header_simple ()
{
    cat <<EOF
{| border="1" class="wikitable sortable"
! Name&nbsp;&&nbsp;Parameters
! class="unsortable"|Description
! Type
EOF
}

table_entry_simple ()
{
    if [ -n "$2" ]
    then
        cat <<EOF
|-
| '''$1'''&nbsp;''$2''
| $3
| $4
EOF
    else
        cat <<EOF
|-
| '''$1'''
| $3
| $4
EOF
    fi
}

table_end ()
{
    echo "|}"
}

