varslist1 = [ rotatemaps spawnrotate selfdamage trialstyle teamdamage spawnhealth maxhealth maxhealthvampire actorscale minresizescale maxresizescale maxcarry regenhealth kamikaze pointlimit capturelimit captureresetdelay ]
varslist2 = [ defendlimit defendpoints defendoccupy defendflags bomberlimit bomberresetdelay bomberspeed gamespeed gravityforce liquidspeedforce liquidcoastforce floorcoastforce aircoastforce slidecoastforce movespeed movecrawl movesprint movejet movestraight movestrafe moveinair movestepup movestepdown jumpspeed impulsespeed impulselimit impulseboost ]
varslist3 = [ impulsedash impulsejump impulsemelee impulseparkour impulseparkournorm impulseallowed impulsestyle impulsecount impulsedelay impulseslide impulsemeter impulsecost impulseskate impulsesprint impulsejet impulseregen impulseregencrouch impulseregensprint impulseregenjet impulseregenmove impulseregeninair damagescale criticalchance ]
varslist4 = [ itemsallowed hitpushscale hitslowscale deadpushscale wavepushscale waveslowscale timelimit triallimit intermlimit votelimit duelreset duelclear duellimit itemspawntime itemspawndelay itemspawnstyle itemthreshold regendelay regentime enemyspawntime enemyspawndelay enemyspawnstyle spawngrenades spawnweapon instaweapon ]

varsmenu = [
    guifont "little" [
        guilist [
            guilistsplit n 4 "1 2 3 4" [
                guilist [
                    guilist [ looplist var $[varslist@n] [vardef $var $var] ]
                    guistrut 2
                    guilist [ looplist var $[varslist@n] [varfld $var 8] ]
                ]
                if (= $n 4) [
                    guistrut 0.5
                    guilist [guistayopen [
                        guistrut 4
                        guibutton "^foreset all game variables" [resetvars]
                    ]]
                ]
            ] [guistrut 3]
        ]
    ]
]

weapindex = 0
weapmenuinit = [ weapindex = 0 ]
weapindexdelta = [
    weapindex = (+ $weapindex $arg1)
    if (< $weapindex 0) [ weapindex = (+ $weapindex $weapidxnum) ]
    if (>= $weapindex $weapidxnum) [ weapindex = (- $weapindex $weapidxnum) ]
]
weapcollidevars = ["traced" "hit proj" "hit owner" "impact geom" "impact plyr" "impact shot" "bounce geom" "bounce plyr" "bounce shot" "drill geom" "drill plyr" "drill shot" "stick geom" "stick plyr"]

weapmenu = [
    guistayopen [
        guilist [
            weap = (getweap $weapindex -1)
            guilist [
                guiimage (getweap $weapindex 1) [weapindexdelta 1] 1.25 0 "textures/nothumb"
                guistrut 0.5
                guilist [
                    guifont default [ guitext [@weap (@[weapindex]/@(+ $weapindex $weapidxnum))] ]
                    guilist [
                        guibutton "^fo<prev" [weapindexdelta -1]
                        guistrut 1
                        guibutton "^fynext>" [weapindexdelta 1]
                    ]
                ]
            ]
            guistrut 1
            guifont "little" [
                guilist [
                    guilist [
                        vardef   [@[weap]name]    "name"
                        varhdef  [@[weap]colour]  "colour"
                        varhdef2 [@[weap]partcol] "partcol"
                        varhdef2 [@[weap]explcol] "explcol"
                        vardef   [@[weap]add]     "add"
                        vardef   [@[weap]max]     "max"
                        vardef2  [@[weap]sub]     "reduced"
                        vardef2  [@[weap]attackdelay]  "attackdelay"
                        vardef   [@[weap]reloaddelay]  "reloaddelay"
                        vardef2  [@[weap]damage]  "damage"
                        vardef2  [@[weap]speed]   "speed"
                        vardef2  [@[weap]power]   "power"
                        vardef2  [@[weap]time]    "time"
                        vardef2  [@[weap]projdelay]  "projdelay"
                        vardef2  [@[weap]guideddelay]  "guideddelay"
                        vardef2  [@[weap]escapedelay]  "escapedelay"
                        vardef2  [@[weap]explode] "explode"
                    ]
                    guistrut 2
                    guilist [
                        varfld  [@[weap]name]    16
                        varfld  [@[weap]colour]  16
                        varfld2 [@[weap]partcol] 7
                        varfld2 [@[weap]explcol] 7
                        varfld  [@[weap]add]     16
                        varfld  [@[weap]max]     16
                        varfld2 [@[weap]sub]     7
                        varfld2 [@[weap]attackdelay]  7
                        varfld  [@[weap]reloaddelay]  16
                        varfld2 [@[weap]damage]  7
                        varfld2 [@[weap]speed]   7
                        varfld2 [@[weap]power]   7
                        varfld2 [@[weap]time]    7
                        varfld2 [@[weap]projdelay]  7
                        varfld2 [@[weap]guideddelay]  7
                        varfld2 [@[weap]escapedelay]  7
                        varfld2 [@[weap]explode] 7
                    ]
                ]
            ]
        ]
        guistrut 2
        guifont "little" [
            guilist [
                guilist [
                    guilist [
                        vardef2 [@[weap]rays]         "rays"
                        vardef2 [@[weap]spread]       "spread"
                        vardef2 [@[weap]zdiv]         "zdiv"
                        vardef2 [@[weap]aiskew]       "aiskew"
                        vardef2 [@[weap]fragweap]     "fragweap"
                        vardef2 [@[weap]flakdamage]   "flakdamage"
                        vardef2 [@[weap]fragrays]     "fragrays"
                        vardef2 [@[weap]fragtime]     "fragtime"
                        vardef2 [@[weap]fragspeed]    "fragspeed"
                        vardef2 [@[weap]cooked]       "cooked"
                        vardef2 [@[weap]guided]       "guided"
                        vardef2 [@[weap]extinguish]   "extinguish"
                        vardef2 [@[weap]radial]       "radial"
                        vardef2 [@[weap]residual]     "residual"
                        vardef  [@[weap]reloads]      "reloads"
                        vardef  [@[weap]carried]      "carried"
                        vardef  [@[weap]zooms]        "zooms"
                        vardef2 [@[weap]fullauto]     "fullauto"
                        vardef  [@[weap]allowed]      "allowed"
                        vardef2 [@[weap]critdash]     "critdash"
                        vardef2 [@[weap]taperin]      "taperin"
                        vardef2 [@[weap]taperout]     "taperout"
                        vardef2 [@[weap]elasticity]   "elasticity"
                        vardef2 [@[weap]reflectivity] "reflectivity"
                        vardef2 [@[weap]relativity]   "relativity"
                    ]
                    guistrut 2
                    guilist [
                        varfld2 [@[weap]rays]         7
                        varfld2 [@[weap]spread]       7
                        varfld2 [@[weap]zdiv]         7
                        varfld2 [@[weap]aiskew]       7
                        varfld2 [@[weap]fragweap]     7
                        varfld2 [@[weap]fragdamage]   7
                        varfld2 [@[weap]fragrays]     7
                        varfld2 [@[weap]fragtime]     7
                        varfld2 [@[weap]fragspeed]    7
                        varfld2 [@[weap]cooked]       7
                        varfld2 [@[weap]guided]       7
                        varfld2 [@[weap]extinguish]   7
                        varfld2 [@[weap]radial]       7
                        varfld2 [@[weap]residual]     7
                        varfld  [@[weap]reloads]      16
                        varfld  [@[weap]carried]      16
                        varfld  [@[weap]zooms]        16
                        varfld2 [@[weap]fullauto]     7
                        varfld  [@[weap]allowed]      16
                        varfld2 [@[weap]critdash]     7
                        varfld2 [@[weap]taperin]      7
                        varfld2 [@[weap]taperout]     7
                        varfld2 [@[weap]elasticity]   7
                        varfld2 [@[weap]reflectivity] 7
                        varfld2 [@[weap]relativity]   7
                    ]
                ]
            ]
            guistrut 3
            guilist [
                guilist [
                    guilist [
                        vardef2 [@[weap]waterfric]  "waterfric"
                        vardef2 [@[weap]weight]     "weight"
                        vardef2 [@[weap]radius]    "radius"
                        vardef2 [@[weap]kickpush]   "kickpush"
                        vardef2 [@[weap]hitpush]    "hitpush"
                        vardef2 [@[weap]slow]       "slow"
                        vardef2 [@[weap]aidist]     "aidist"
                        vardef2 [@[weap]partsize]   "partsize"
                        vardef2 [@[weap]partlen]    "partlen"
                        vardef  [@[weap]frequency]  "frequency"
                        vardef2 [@[weap]wavepush]   "wavepush"
                        vardef  [@[weap]critmult]   "critmult"
                        vardef  [@[weap]critdist]   "critdist"
                        vardef2 [@[weap]delta]      "delta"
                        vardef2 [@[weap]trace]      "trace"
                        vardef2 [@[weap]headmin]    "headmin"
                        vardef2 [@[weap]whipdamage]  "whipdamage"
                        vardef2 [@[weap]torsodamage] "torsodamage"
                        vardef2 [@[weap]legdamage]  "legdamage"
                        vardef2 [@[weap]fragscale]  "fragscale"
                        vardef2 [@[weap]fragspread] "fragspread"
                        vardef2 [@[weap]fragrel]    "fragrel"
                        vardef2 [@[weap]fragjump]   "fragjump"
                        vardef2 [@[weap]fragoffset] "fragoffset"
                        vardef2 [@[weap]fragskew]   "fragskew"
                    ]
                    guistrut 2
                    guilist [
                        varfld2 [@[weap]waterfric]  7
                        varfld2 [@[weap]weight]     7
                        varfld2 [@[weap]radius]     7
                        varfld2 [@[weap]kickpush]   7
                        varfld2 [@[weap]hitpush]    7
                        varfld2 [@[weap]slow]       7
                        varfld2 [@[weap]aidist]     7
                        varfld2 [@[weap]partsize]   7
                        varfld2 [@[weap]partlen]    7
                        varfld  [@[weap]frequency]  16
                        varfld2 [@[weap]wavepush]   7
                        varfld  [@[weap]critmult]   16
                        varfld  [@[weap]critdist]   16
                        varfld2 [@[weap]delta]      7
                        varfld2 [@[weap]trace]      7
                        varfld2 [@[weap]headmin]    7
                        varfld2 [@[weap]whipdamage]    7
                        varfld2 [@[weap]torsodamage]   7
                        varfld2 [@[weap]legdamage]    7
                        varfld2 [@[weap]fragscale]  7
                        varfld2 [@[weap]fragspread] 7
                        varfld2 [@[weap]fragrel]    7
                        varfld2 [@[weap]fragjump]   7
                        varfld2 [@[weap]fragoffset] 7
                        varfld2 [@[weap]fragskew]   7
                    ]
                ]
            ]
            guistrut 3
            guilist [
                loop n 2 [
                    guilist [
                        push n (at "collide flakcollide" $n) [
                            guilist [
                                vardef2 [@[weap]@n] (format "^fw%1" (at [collision: "flak collision:"] @@n))
                                looplist a $weapcollidevars [guitext $a]
                            ]
                            guistrut 2
                            guilist [
                                guitext "^fwpri^fa/^fwalt"
                                loop b (listlen $weapcollidevars) [
                                    varbit2 [@[weap]@n] (<< 1 $b)
                                ]
                            ]
                        ]
                    ]
                    if (= $n 0) [guistrut 2]
                ]
            ]
        ]
    ]
]

newgui vars [
    guilist [ varsmenu ]
    guitab "weap"
    guilist [ weapmenu ]
] [
    if (= $guipasses 0) [
        weapmenuinit
    ]
]
