// Red Eclipse: Default Configuration

exec "keymap.cfg"
exec "engine.cfg"
exec "brush.cfg"
exec "sounds.cfg"
exec "usage.cfg"
if (! (strcmp $versionuname "mekarcade")) [
    exec "vanity.cfg"
]

complete exec .

mapcomplete     = [ setcomplete $arg1 1; complete $arg1 maps mpz ]; mapcomplete map
start           = [ mode $arg2 $arg3; map $arg1 ]; mapcomplete start

demo            = [ stopdemo; start $arg1 0 0 ]; complete demo demos dmo

edit            = [ start $arg1 $modeidxediting 0 ]; mapcomplete edit
if (strcmp $versionuname "mekarcade") [
    campaign    = [ start $arg1 $modeidxcampaign 0 ]; mapcomplete campaign
]
deathmatch      = [ start $arg1 $modeidxdeathmatch 0 ]; mapcomplete deathmatch; dm = [ deathmatch $arg1 ]; mapcomplete dm
teamdm          = [ start $arg1 $modeidxdeathmatch $mutsbitteam ]; mapcomplete teamdm; tdm = [ teamdm $arg1 ]; mapcomplete tdm
multidm         = [ start $arg1 $modeidxdeathmatch $mutsbitmulti ]; mapcomplete multidm; mdm = [ multidm $arg1 ]; mapcomplete mdm
coop            = [ start $arg1 $modeidxdeathmatch $mutsbitcoop ]; mapcomplete coop; cdm = [ coop $arg1 ]; mapcomplete cdm
capture         = [ start $arg1 $modeidxcapture 0]; mapcomplete capture; ctf = [ capture $arg1 ]; mapcomplete ctf
defend          = [ start $arg1 $modeidxdefend 0 ]; mapcomplete defend; dtf = [ defend $arg1 ]; mapcomplete dtf
bomber          = [ start $arg1 $modeidxbomber 0 ]; mapcomplete bomber; bb = [ bomber $arg1 ]; mapcomplete bb
timetrial       = [ start $arg1 $modeidxtrial 0 ]; mapcomplete timetrial; trial = [ timetrial $arg1 ]; mapcomplete trial
gauntlet        = [ start $arg1 $modeidxgauntlet 0 ]; mapcomplete gauntlet
instagib        = [ start $arg1 $modeidxdeathmatch $mutsbitinstagib ]; mapcomplete instagib; insta = [ instagib $arg1 ]; mapcomplete insta
medieval        = [ start $arg1 $modeidxdeathmatch $mutsbitmedieval ]; mapcomplete medieval
kaboom          = [ start $arg1 $modeidxdeathmatch $mutsbitkaboom ]; mapcomplete kaboom
duel            = [ start $arg1 $modeidxdeathmatch $mutsbitduel ]; mapcomplete duel
survivor        = [ start $arg1 $modeidxdeathmatch $mutsbitsurvivor ]; mapcomplete survivor; lms = [ survivor $arg1 ]; mapcomplete lms
classic         = [ start $arg1 $modeidxdeathmatch $mutsbitclassic ]; mapcomplete classic

delta_game_0 = [ if (iszooming) [ setzoom $arg1 ] [ weapon -1 $arg1 ] ]
delta_spec_0 = [ followdelta $arg1 ]
delta_wait_0 = [ followdelta $arg1 ]

delta_edit_0 = [
    if $blendpaintmode [
        nextblendbrush $arg1
        echo (concatword "^fgblend brush:^fw " (getblendbrushname (curblendbrush)))
    ] [
        editfacewentpush $arg1 1
    ]
]

delta_edit_1    = [ nodebug [ gridpower (+ $arg1 $gridpower) ] ]
delta_edit_2    = [ editfacewentpush $arg1 0 ] // push face/corners selected
delta_edit_3    = [ editfacewentpush $arg1 2 ] // push corner pointed at by cursor
delta_edit_4    = [ editrotate $arg1 ] // rotate 90 degrees
delta_edit_5    = [ entproperty 0 $arg1 ] // and the others
delta_edit_6    = [ edittex $arg1 ] // change textures
delta_edit_9    = [ selectbrush $arg1 ] // change heightmap brushes
delta_edit_10   = [ entautoview $arg1 ]
delta_edit_11   = [ entproperty 0 $arg1 ]
delta_edit_12   = [ entproperty 1 $arg1 ]
delta_edit_13   = [ entproperty 2 $arg1 ]
delta_edit_14   = [ entproperty 3 $arg1 ]
delta_edit_15   = [ entproperty 4 $arg1 ]
delta_edit_16   = [ entproperty 5 $arg1 ]
delta_edit_17   = [ entproperty 6 $arg1 ]
delta_edit_18   = [ entproperty 7 $arg1 ]
delta_edit_19   = [ entproperty 8 $arg1 ]

shiftfloatspeed = 500; setcomplete shiftfloatspeed 1; setpersist shiftfloatspeed 1
shiftmodscale = 10; setcomplete shiftmodscale 1; setpersist shiftmodscale 1
oldfloatspeed = $floatspeed
shiftmod = [
    if $arg1 [
        oldfloatspeed = $floatspeed
        floatspeed $shiftfloatspeed
        modscale = $shiftmodscale
    ] [
        floatspeed $oldfloatspeed
        modscale = 1
    ]
]

// actions: attack = 0, alternate = 1, reload = 2, use = 3, jump = 4, impulse = 5, crouch = 6, special = 7

bind MOUSE1         [ action 0 ] // attack
bind MOUSE2         [ action 1 ] // alt-attack
bind MOUSE3         [ action 2 ] // reload
bind MOUSE4         [ universaldelta 1 ]    // also used for editing, see below
bind MOUSE5         [ universaldelta -1 ]
bind LEFTBRACKET    [ universaldelta 1 ]
bind RIGHTBRACKET   [ universaldelta -1 ]

specbind LSHIFT     [ shiftmod 1; onrelease [ shiftmod 0 ] ]
specbind E          [ spectator 0 ]
specbind MOUSE1     [ universaldelta -1 ]
specbind MOUSE2     [ spectator 0 ]
specbind HOME       [ specmodeswitch ]
specbind R          [ specmodeswitch ]
specbind MOUSE3     [ specmodeswitch ]

waitbind LSHIFT     [ shiftmod 1; onrelease [ shiftmod 0 ] ]
waitbind MOUSE1     [ universaldelta -1 ]
waitbind MOUSE2     [ universaldelta 1 ]
waitbind END        [ waitmodeswitch ]
waitbind R          [ waitmodeswitch ]
waitbind MOUSE3     [ waitmodeswitch ]

bind END            [ kill ]

bind W              [ forward ]
bind A              [ left ]
bind S              [ backward ]
bind D              [ right ]

bind UP             [ forward ]
bind DOWN           [ backward ]
bind RIGHT          [ right ]
bind LEFT           [ left ]

bind SPACE          [ action 4 ] // jump
bind LCTRL          [ action 5 ] // run/walk
bind LSHIFT         [ action 6 ] // crouch
bind E              [ action 3 ] // action
bind R              [ action 2 ] // reload
bind Q              [ action 7 ] // special
bind Z              [ action 8 ] // drop
bind F              [ action 9 ] // affinity
bind C              [ action 6 ] // crouch
bind G              [ weapon 8 ] // grenades
bind K              [ kill ]

bind TAB            [ showscores ]

saytextcommand =    [inputcommand $arg1 [say $commandbuffer] "textures/chat" 0 "s"]
sayteamcommand =    [inputcommand $arg1 [sayteam $commandbuffer] (getplayerteamicon) (getplayerteamcolour) 0 "s"]

bind T              [ saytextcommand ]
bind RETURN			[ saytextcommand ]
bind BACKQUOTE      "saycommand /"
bind SLASH          "saycommand /"
bind Y              [ sayteamcommand ]

bind KP_MINUS       [ mastervol (max (- $mastervol 5) 0) ]
bind KP_PLUS        [ mastervol (min (+ $mastervol 5) 255) ]
bind KP_DIVIDE      [ togglesound ]

bind PAUSE          [ gamepaused (! $gamepaused) ]
bind PAGEDOWN       [ conskip (- 0 $consize) ]
bind PAGEUP         [ conskip $consize ]

addbot =            [ botoffset (+ $botoffset 1) ]
delbot =            [ botoffset (- $botoffset 1) ]

bind INSERT         [ addbot ]
bind DELETE         [ delbot ]
bind HOME           [ spectator 1 ]
bind END            [ spectator 0 ]

bind F1             [ edittoggle ]
bind F2             [ showgui maps 1 ]
bind F3             [ showgui maps 2 ]
bind F4             [ showgui servers ]
bind F5             [ setmaster 1 ]
bind F6             [ showgui loadout ]
bind F7             [ showgui team ]
bind COMMA          [ showgui loadout ]
bind PERIOD         [ showgui team ]
bind F9             [ thirdpersonswitch ]
bind F10            [ grabinput (! $grabinput) ]
bind F11            [ toggleconsole ]
bind F12            [ screenshot ]

editbind F2         [ showtexgui ]
editbind F3         [ showgui editing ]
editbind F4         [ remip ]
editbind F5         [ fullbright 0; patchlight]
editbind F6         [ fullbright 0; calclight -1 ]
editbind F7         [ fullbright 0; calclight 1 ]
editbind F8         [ savemap ]
editbind F9         [ changeoutline 1 ]

bind 0              [ weapon 0 ]
bind 1              [ weapon 1 ]
bind 2              [ weapon 2 ]
bind 3              [ weapon 3 ]
bind 4              [ weapon 4 ]
bind 5              [ weapon 5 ]
bind 6              [ weapon 6 ]
bind 7              [ weapon 7 ]
bind 8              [ weapon 8 ]
bind 9              [ weapon 9 ]

editbind 1          [ domodifier 11 ]
editbind 2          [ domodifier 12 ]
editbind 3          [ domodifier 13 ]
editbind 4          [ domodifier 14 ]
editbind 5          [ domodifier 15 ]
editbind 6          [ domodifier 16 ]
editbind 7          [ domodifier 17 ]
editbind 8          [ domodifier 18 ]
editbind 9          [ domodifier 19 ]

editbind K          [ domodifier 9 ]

editbindvar 0       allfaces
editbindvar M       showmat
editbindvar O       outline


editbind INSERT     [ sendmap ]
editbind DELETE     [ getmap ]
editbind LSHIFT     [ shiftmod 1; onrelease [ shiftmod 0 ] ]
editbind END	    [ entcancel ]

oldpassthroughsel = 0
oldpassthroughcube = 0
passthrough = [
    if (= $arg1 1) [
        oldpassthroughsel = $passthroughsel
        oldpassthroughcube = $passthroughcube
        passthroughsel 1; passthroughcube 1
    ] [
        passthroughsel $oldpassthroughsel
        passthroughcube $oldpassthroughcube
    ]
    entcancel
]; setcomplete passthrough 1
editbind LCTRL      [ passthrough 1; onrelease [ passthrough 0 ] ]
editbind LALT       [ hmapedit 0; blendpaintmode 0 ]

gridbindswitch = 0
togglegrid = [
    case $gridbindswitch 3 [
        showpastegrid 0; showcursorgrid 0; showselgrid 0; gridbindswitch = 0
    ] 2 [
        showpastegrid 0; showcursorgrid 0; showselgrid 1; gridbindswitch = 3
    ] 1 [
        showpastegrid 0; showcursorgrid 1; showselgrid 0; gridbindswitch = 2
    ] 0 [
        showpastegrid 1; showcursorgrid 0; showselgrid 0; gridbindswitch = 1
    ]
]; setcomplete togglegrid 1

editbind TAB        [ togglegrid ]

editbind SPACE      [ cancelsel ]
editbind MOUSE1     [ if $blendpaintmode paintblendmap editdrag ]
editbind MOUSE3     [ selcorners ]
editbind MOUSE2     [ if $blendpaintmode rotateblendbrush editextend ]

editbind N          [ entselect insel ]
do [brush_2] //421

editbind L          [ entlink ]
editbind X          [ editflip ]
editbind C          [ editcopy ]
editbind V          [ editpaste ]
editbind U          [ editcut ]
editbind Z          [ undo; passthroughsel 0 ]
editbind I          [ redo ]
editbind H          [ hmapedit (! $hmapedit) ; blendpaintmode 0 ]

editbind BACKSPACE  [ editdel ]

editbind G          [ domodifier 1 ] // domodifier 1 -> executes delta_edit_1
editbind F          [ domodifier 2 ] // etc...
editbind Q          [ domodifier 3 ]
editbind R          [ domodifier 4 ]
editbind Y          [ domodifier 6 ]
editbind J          [ gettex ]
editbind COMMA      [ domodifier 10; onrelease entautoview ]

editbind PERIOD     selentedit

paintmodes = ["off" "overwrite blendmap" "merge blendmap" "max opacity to brush's" "inverted merge" "opacity multiplier (erasing)"]

editbind P [
    hmapedit 0;
    blendpaintmode (if (= $blendpaintmode 5) 0 (+ $blendpaintmode 1));
    echo (concatword "^fgblend mode:^fw " (at $paintmodes $blendpaintmode))
]
editbindvar B       fullbright

editbind KP0        [ showgui materials ]
editbind KP1        [ editmat air ]
editbind KP2        [ editmat alpha ]
editbind KP3        [ editmat water ]
editbind KP4        [ editmat lava ]
editbind KP5        [ editmat clip ]
editbind KP6        [ editmat noclip]
editbind KP7        [ editmat aiclip ]
editbind KP8        [ editmat death ]
editbind KP9        [ editmat ladder ]

enttypelist = [
    light
    mapmodel
    playerstart
    envmap
    particles
    sound
    lightfx
    sunlight
    weapon
    teleport
    actor
    trigger
    pusher
    affinity
    checkpoint
    dummy1
    dummy2
]

entcomplete = [ listcomplete $arg1 $enttypelist ]

// entcomplete gets defined by game
entcomplete newent
entcomplete entfind

enttypeselect = [
    enttypelength = (listlen $enttypelist)
    next = (mod (+ (indexof $enttypelist (enttype)) $arg1) $enttypelength)
    if (< $next 0) [ next = (+ $next $enttypelength) ]
    do [entset @(listsplice (entget) (at $enttypelist $next) 0 1)]
]

slime = [
    editmat water
    editmat death
    obitwater "sucked on slime"
    watercolour 0x182200
    waterfallcolour 0x002200
    waterfog 0
    waterspec 10
]

exec "tips.cfg"
exec "menus.cfg" // keep this here, it uses some of the stuff above
exec "voice.cfg"
exec "compass.cfg"

// people have complained /fov was removed
fov = [[@(? (isthirdperson) third first)personfov] $arg1]; setcomplete fov 1
texturecull = [ compactvslots 1 ]; setcomplete texturecull 1
name = [playername $arg1]; setcomplete name 1
colour = [playercolour $arg1]; setcomplete colour 1
setinfo = [playername $arg1; playercolour $arg2; playermodel $arg3; if (! (strcmp $versionuname "mekarcade")) [playervanity $arg4]]; setcomplete colour 1
setmaster = [ setpriv $arg1 ]; setcomplete setmaster 1

oldshowhud = 0; oldshowconsole = 0
oldscreenshot = [
    if (= $arg1 1) [
        oldshowhud = $showhud; oldshowconsole = $showconsole; showhud 0; showconsole 0
    ] [showhud $oldshowhud; showconsole $oldshowconsole]
]
takescreenshot = [ oldscreenshot 1; sleep 500 [ screenshot "screenshot"; oldscreenshot 0 ] ]; setcomplete takescreenshot 1

// sauer rotation aliases
alias octamaps [
    allowmaps "complex douze ot academy metl2 metl3 nmp8 refuge tartech kalking1 dock turbine fanatic_quake oddworld wake5 aard3c curvedm fragplaza pgdm kffa neondevastation hog2 memento neonpanic lostinspace DM_BS1 shindou sdm1 shinmei1 stemple powerplant phosgene oasis island metl4 ruby frozen ksauer1 killfactory corruption deathtek aqueducts orbe roughinery shadowed torment moonlite darkdeath orion nmp10 katrez_d thor frostbyte ogrosupply kmap5 thetowers guacamole tejen hades paradigm mechanic wdcd"
    mainmaps "complex douze ot academy metl2 metl3 nmp8 refuge tartech kalking1 dock turbine fanatic_quake oddworld wake5 aard3c curvedm fragplaza pgdm kffa neondevastation hog2 memento neonpanic lostinspace DM_BS1 shindou sdm1 shinmei1 stemple powerplant phosgene oasis island metl4 ruby frozen ksauer1 killfactory corruption deathtek aqueducts orbe roughinery shadowed torment moonlite darkdeath orion nmp10 katrez_d thor frostbyte ogrosupply kmap5 thetowers guacamole tejen hades paradigm mechanic wdcd"
    capturemaps "hallo reissen flagstone face-capture shipwreck dust2 urban_c berlin_wall akroseum valhalla damnation mach2 redemption tejen europium capture_night l_ctf forge campo wdcd sacrifice core_transfer recovery"
    defendmaps "urban_c nevil_c fb_capture nmp9 c_valley lostinspace fc3 face-capture nmp4 nmp8 hallo monastery ph-capture hades fc4 relic frostbyte venice paradigm corruption asteroids ogrosupply reissen akroseum duomo capture_night c_egypt tejen dust2 campo killcore3 damnation arabic cwcastle river_c serenity"
    bombermaps "hallo reissen flagstone face-capture shipwreck dust2 urban_c berlin_wall akroseum valhalla damnation mach2 redemption tejen europium capture_night l_ctf forge campo wdcd sacrifice core_transfer recovery"
    holdmaps "complex douze ot academy metl2 metl3 nmp8 refuge tartech kalking1 dock turbine fanatic_quake oddworld wake5 aard3c curvedm fragplaza pgdm kffa neondevastation hog2 memento neonpanic lostinspace DM_BS1 shindou sdm1 shinmei1 stemple powerplant phosgene oasis island metl4 ruby frozen ksauer1 killfactory corruption deathtek aqueducts orbe roughinery shadowed torment moonlite darkdeath orion nmp10 katrez_d thor frostbyte ogrosupply kmap5 thetowers guacamole tejen hades paradigm mechanic wdcd"
]
